<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maple To Do Checklist</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="css/1.css" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <script type="module">

        // Firebase SDK 라이브러리 가져오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, collection, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // Firebase 구성 정보 설정
        const firebaseConfig = {
            apiKey: "AIzaSyAIP8svZiWmrZ5hcYP2R-qSeGapwrJESxk",
            authDomain: "ilboon.firebaseapp.com",
            projectId: "ilboon",
            storageBucket: "ilboon.appspot.com",
            messagingSenderId: "889902979830",
            appId: "1:889902979830:web:e06a486199415e115bead7",
            measurementId: "G-RZSDVG93QH"
        };

        // Firebase 인스턴스 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // 각 체크박스의 변경 이벤트 핸들러 설정
        $("#hilla, #pinkbean, #cygnus, #zakum, #vonbon, #bloodyqueen, #pierre, #vellum, #magnus, #papulatus").each(async function () {
            // 체크박스 id와 상태 가져오기
            let id = $(this).attr("id");
            let isChecked = localStorage.getItem(id) === "true"; // 로컬 스토리지에서 상태 가져오기
            $(this).prop("checked", isChecked); // 체크박스 상태 설정

            $(this).click(async function () {
                let isChecked = $(this).prop("checked");
                localStorage.setItem(id, isChecked); // 변경된 상태를 로컬 스토리지에 저장

                // Firestore 문서 업데이트
                const docRef = doc(db, "meggiggi", "acPB3DZveunwh9LmsZaj");
                const docSnap = await getDoc(docRef);

                // 문서가 존재하는지 확인 후 수정
                if (docSnap.exists()) {
                    try {
                        // 기존 문서 데이터를 가져와서 업데이트할 내용 추가
                        let updatedData = docSnap.data();
                        updatedData[id] = isChecked;

                        // 업데이트된 데이터로 문서를 업데이트
                        await setDoc(docRef, updatedData);
                        console.log('Firestore 문서 업데이트 완료!');
                    } catch (error) {
                        console.error('Firestore 문서 업데이트 중 오류 발생:', error);
                    }
                } else {
                    console.log("해당 문서가 존재하지 않습니다.");
                }
            });
        });

        // 매주 목요일에 모든 체크리스트를 false로 설정
        $(document).ready(function () {
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0 (일요일)부터 6 (토요일)까지의 값을 반환
            if (dayOfWeek === 4) { // 목요일인 경우 (일요일을 0으로 시작하기 때문에 목요일은 4입니다)
                resetChecklist(); // 모든 체크리스트를 false로 변경하는 함수 호출
            }
        });

        // 모든 체크리스트를 false로 변경하는 함수
        async function resetChecklist() {
            const checkboxes = ["hilla", "pinkbean", "cygnus", "zakum", "vonbon", "bloodyqueen", "pierre", "vellum", "magnus", "papulatus"];
            checkboxes.forEach(async function (id) {
                localStorage.setItem(id, "false"); // 로컬 스토리지에 해당 체크리스트를 false로 설정
                const docRef = doc(db, "meggiggi", "acPB3DZveunwh9LmsZaj");
                const docSnap = await getDoc(docRef);

                // 문서가 존재하는지 확인 후 수정
                if (docSnap.exists()) {
                    try {
                        // 기존 문서 데이터를 가져와서 업데이트할 내용 추가
                        let updatedData = docSnap.data();
                        updatedData[id] = false;

                        // 업데이트된 데이터로 문서를 업데이트
                        await setDoc(docRef, updatedData);
                        console.log('Firestore 문서 업데이트 완료!');
                    } catch (error) {
                        console.error('Firestore 문서 업데이트 중 오류 발생:', error);
                    }
                } else {
                    console.log("해당 문서가 존재하지 않습니다.");
                }
            });
        }

    </script>
</head>

<body>
    <div id="container">
        <div id="wrapper">

            <!--헤더-->
            <div id="header">
                <h1><img src="https://maplescouter.com/images/logo.png" alt="MapleScouter 로고" class="logo"
                        style="max-width: 50px;">
                    <a href="index.html">Maple To Do Checklist</a>
                </h1>
                <h2>If you're worried, try using this</h2>
            </div>

            <!-- 캐릭터 정보 -->
            <div id="sidebar">
                <div>
                    <img class="user-img"
                        src="https://open.api.nexon.com/static/maplestory/Character/PNFHNODPHFHKCKDENABNEFKDLKPDOEGHPOMADFMHINGHHLNLNLEEKJGKJJCPHNIHKIAOBCCDNKJLCKMIMAMKBJIOLHMFPKGEDPFDKBJEEAAAPFPDIDMJHEOLANJBMKHGOPHEAAOPEPJJJGMNHELNAEAIHOJIFIOIDBNKBOCLIABKJODNFAMLKCKKCMBFGKKDNABCGOHPADDAHJMEMFCJGBMCOGDJCCJMKOFPOLAEELFKNHBACNEOLOPDFJDGHOBG.png"
                        width="240" height="240">
                </div>
                <div class="user-info">
                    <div>
                        <span id="nickname">퇴사한나도</span>
                        <span id="level">272</span>
                    </div>
                    <div>
                        <span id="job">엔젤릭버스터</span>
                        <span id="level-text"> Level</span>
                    </div>
                </div>
                <div>
                    <div>
                        <span style="color:#f27373; font-size: 18px; margin-right: 45px;">월드</span>
                        <span style="color:gray; font-size: 18px;">루나</span>
                    </div>
                    <div>
                        <span style="color:#f27373; font-size: 18px; margin-right: 45px;">길드</span>
                        <span style="color:gray; font-size: 18px;">구름</span>
                    </div>
                </div>

                <!--하이퍼링크 메뉴-->
                <div id="button">
                    <ul>
                        <div class="svg-wrapper">
                            <svg height="40" width="150" xmlns="http://www.w3.org/2000/svg">
                                <rect id="shape" height="40" width="150" />
                                <div id="text">
                                    <a
                                        href="https://namu.wiki/w/%EB%A9%94%EC%9D%B4%ED%94%8C%EC%8A%A4%ED%86%A0%EB%A6%AC/%EB%B3%B4%EC%8A%A4%20%EB%AA%AC%EC%8A%A4%ED%84%B0">
                                        <span class="spot"></span><img
                                            src="https://i.namu.wiki/i/liyehGoPh7TyOV-SJfslSLGkIXTcGYic94Jc_zAnO7KZrssnHtJOqS_41FBsf2wFGvRowpu2YjIFE4-QQUdWcA.webp"
                                            alt="MapleScouter 로고" class="logo" style="max-width: 30px;"> BOSS</a>
                                </div>
                            </svg>
                        </div>

                        <div class="svg-wrapper">
                            <svg height="40" width="150" xmlns="http://www.w3.org/2000/svg">
                                <rect id="shape" height="40" width="150" />
                                <div id="text">
                                    <a href="https://maplestory.nexon.com/News/Event">
                                        <span class="spot"></span>
                                        <img src="https://maplescouter.com/images/logo.png" alt="MapleScouter 로고"
                                            class="logo" style="max-width: 30px;">EVENT</a>
                                </div>
                            </svg>
                        </div>

                        <div class="svg-wrapper">
                            <svg height="40" width="150" xmlns="http://www.w3.org/2000/svg">
                                <rect id="shape" height="40" width="150" />
                                <div id="text">
                                    <a href="https://maplestory.nexon.com/News/Notice">
                                        <span class="spot"></span>
                                        <img src="https://lwi.nexon.com/maplestory/banner/2024/0321/bn_update_240321_44P64K18874VMD3M.png"
                                            alt="MapleScouter 로고" class="logo" style="max-width: 30px;"> NEWS</a>
                                </div>
                            </svg>
                        </div>

                        <div class="svg-wrapper">
                            <svg height="40" width="150" xmlns="http://www.w3.org/2000/svg">
                                <rect id="shape" height="40" width="150" />
                                <div id="text">
                                    <a href="https://maple.gg/">
                                        <span class="spot"></span>
                                        <img src="https://maplescouter.com/images/logo.png" alt="MapleScouter 로고"
                                            class="logo" style="max-width: 30px;"> M.GG</a>
                                </div>
                            </svg>
                        </div>

                    </ul>
                </div><!--하이퍼링크 메뉴-->

            </div><!--캐릭터 정보-->

            <!--체크리스트-->
            <div id="content">

                <ul id="nav">
                    <li><a href="#intro" accesskey="h"><em>일</em>간</a></li>
                    <li><a href="#footer" accesskey="h"><em>주</em>간</a></li>
                    <li><a href="https://teamsparta.notion.site/20-2fe34877b5984a23a56bb1f0e3e2f0f3"
                            accesskey="e"><em>아</em>무거나</a></li>
                </ul>

                <div id="content_main">
                    <h2><a id="intro">Project 소개ㅋㅋ</a></h2>
                    <p class="details"> <a href="https://maplestory.nexon.com/Home/Main" class="comlink">Maple</a>Made
                        in
                        <a href="https://www.nexon.com/Home/Game">NEXON</a> on 2003.4.29.
                    </p>
                    <p> 인생을 살아가려면 꼭 필요한 <strong>Maple To Do Checklist </strong>. 아주 쌈뽕하고 잘빠졌죠? 사람이라면 이 것을 써야함. </p>
                    <h3>Check List</h3>

                    <ul>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="hilla">
                            <label class="form-check-label" for="hilla">
                                힐라(하드)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="pinkbean">
                            <label class="form-check-label" for="pinkbean">
                                핑크빈(하드)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="cygnus">
                            <label class="form-check-label" for="cygnus">
                                시그너스(이지, 노말)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="zakum">
                            <label class="form-check-label" for="zakum">
                                자쿰(하드)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="vonbon">
                            <label class="form-check-label" for="vonbon">
                                반반(카오스)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="bloodyqueen">
                            <label class="form-check-label" for="bloodyqueen">
                                블러디퀸(카오스)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="pierre">
                            <label class="form-check-label" for="pierre">
                                피에르(카오스)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="vellum">
                            <label class="form-check-label" for="vellum">
                                벨룸(카오스)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="magnus">
                            <label class="form-check-label" for="magnus">
                                매그너스(하드)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="papulatus">
                            <label class="form-check-label" for="papulatus">
                                파풀라투스(카오스)
                            </label>
                        </div>

                        <br>
                        Top 버튼 테스트를 위한 기나긴 박스
                        <br>
                        버튼 위치 애매하고 캐릭터정보 밑부분 너무 허전해서 버튼 위치 옮겨봤어요
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                        <br>
                    </ul>

                </div><!--content_main-->
            </div><!--체크리스트-->
        </div><!--wrapper-->

        <!--푸터-->
        <div id="footer">
            <p class="validate">
                <a href="#container">Top</a>
            </p>
            <span>
                Production : 20조 - <a href="https://teamsparta.notion.site/20-2fe34877b5984a23a56bb1f0e3e2f0f3"
                    style="color: #9485be; text-decoration: none;">메끼끼</a>(Java_5기)
                |
                Member : 남현, 김나은, 이제범<br>E-mail : equis3351@naver.com
            </span>
        </div>

    </div><!--container-->

    <div align=center>Very cool 20 group
        <a href="https://teamsparta.notion.site/20-2fe34877b5984a23a56bb1f0e3e2f0f3"
            style="color: #9485be; text-decoration: none;">Meqqiqqi</a>
    </div>

</body>

</html>